<?xml version = "1.0" encoding = "UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace must indicate mapper interface full package path . It is an alias here-->	
<mapper namespace = "SpringBootDemo.Services.PersonAddressMapper">
       
	 <!--
	 We have two select statements: one to load the Person, 
	 the other to load the Address, and the Person's resultMap personResult 
	 describes that the select Address statement should be used to load its 
	 Address property.
	 -->
	 <resultMap id="personResult" type="Person">
  		<association property="address" column="{id=addressId,}" 
  					 javaType="Address" select="selectAddress"/>
	</resultMap> 
 
  	<select id = "selectAddress" resultType = "Address">
      SELECT * FROM Address WHERE ID = #{id};
   	</select>

	<select id="selectPerson" resultMap="personResult">
	  SELECT * FROM Person WHERE ID = #{id}
	</select> 
	
	<!-- Collection example -->
	
	<resultMap id="addressResult" type="Address">
		<id property="id" column="id"/>
  		<collection  property="personList" column="id" ofType="Person"
  					 select="getPerson"/>
	</resultMap>
	
	<select id="getPerson" resultMap="personResult"> <!-- Use Person object. address =null -->
	  SELECT * FROM Person WHERE addressId = #{id}
	</select> 
   	
	<select id="getResult" resultMap="addressResult">
	  SELECT * FROM Address WHERE id = #{id}
	</select> 

	<!--	
	<select id="selectAddress" parameterType = "int" resultType="Address">
		  select * from Address A left outer join Person P on A.personId = P.id
		  where A.id = #{id}
	</select>
	
	
	<resultMap id="addressMap" type="Address">
	    <id property="id" column="author_id"/>
	  	<id property = "id" column = "ID"/>
		<result property = "address1" column = "address1"/>
		<result property = "address2" column = "address2"/>
		<result property = "city" column = "city"/>
		<result property = "state" column = "state"/>
		<result property = "postalcode" column = "postalcode"/>
	</resultMap>
   
   <resultMap id = "personMap" type = "Person">
   		<id property="id" column="personId"/>
  		<result property="first_name" column="first_name"/>
  		<result property="last_name" column="last_name"/>
  		<result property="age" column="age"/>
  		<result property="phone" column="phone"/>
      	<result property="email" column="email"/>
      	<association property="address" resultMap="addressMap" />
   </resultMap>   
 	-->
    	
</mapper>